(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{TDBs:function(e,t,i){"use strict";i.r(t),i.d(t,"DashboardModule",(function(){return z}));var a,c,n,s,o,r,b,l,p,d,h,u=i("tyNb"),m=i("ofXK"),S=i("3Pt+"),f=i("U/Bw"),g=i("djWg"),v=(i("4XzM"),i("S7rW"),i("OLhb")),y=i("QpY3"),R=i("XGgE"),w=i("fXoL"),M=i("0IaG");function A(e,t){1&e&&(w.Sb(0,"small",48),w.Jc(1," Application name should not be empty. "),w.Rb())}function B(e,t){1&e&&w.Nb(0,"i",49)}function I(e,t){if(1&e&&(w.Sb(0,"small",50),w.Jc(1),w.Rb()),2&e){const e=w.jc(2);w.Bb(1),w.Lc(" Deploying the ",e.newApplicationName,". Please wait a few seconds. ")}}function U(e,t){if(1&e){const e=w.Tb();w.Sb(0,"div",33),w.Sb(1,"form",34,35),w.fc("ngSubmit",(function(){w.zc(e);const t=w.xc(2);return w.jc().createApplication(t.valid)})),w.Sb(3,"div",36),w.Sb(4,"label"),w.Jc(5,"Application Name*"),w.Rb(),w.Sb(6,"input",37,38),w.fc("ngModelChange",(function(t){return w.zc(e),w.jc().newApplicationName=t})),w.Rb(),w.Sb(8,"small",39),w.Jc(9," Applicaton name should be at least 4 characters. "),w.Rb(),w.Hc(10,A,2,0,"small",40),w.Rb(),w.Sb(11,"div",36),w.Sb(12,"label"),w.Jc(13,"WAR File"),w.Rb(),w.Sb(14,"input",41),w.fc("change",(function(t){return w.zc(e),w.jc().handleWarFileInput(t.target.files)})),w.Rb(),w.Sb(15,"small",42),w.Jc(16,"This field is optional. If you have a custom app in a .war format, you may install by uploading."),w.Rb(),w.Rb(),w.Sb(17,"div",43),w.Sb(18,"button",44),w.Hc(19,B,1,0,"i",45),w.Jc(20,"Create"),w.Rb(),w.Sb(21,"button",46),w.fc("click",(function(){return w.zc(e),w.jc().cancelNewApplication()})),w.Jc(22,"Cancel"),w.Rb(),w.Rb(),w.Sb(23,"div",43),w.Hc(24,I,2,1,"small",47),w.Rb(),w.Rb(),w.Rb()}if(2&e){const e=w.xc(2),t=w.xc(7),i=w.jc();w.Bb(6),w.qc("ngModel",i.newApplicationName),w.Bb(2),w.qc("hidden",t.valid||!e.submitted),w.Bb(2),w.qc("ngIf",i.streamNameEmpty),w.Bb(8),w.qc("disabled",i.newAppCreating),w.Bb(1),w.qc("ngIf",i.newAppCreating),w.Bb(5),w.qc("ngIf",i.deployingApplication)}}function C(e,t){1&e&&(w.Sb(0,"th",30),w.Wb(1,d),w.Rb())}function N(e,t){1&e&&(w.Sb(0,"th",30),w.Wb(1,h),w.Rb())}function j(e,t){if(1&e&&(w.Sb(0,"td",30),w.Jc(1),w.Rb()),2&e){const e=w.jc().$implicit;w.Bb(1),w.Kc(e.vodCount)}}function x(e,t){if(1&e&&(w.Sb(0,"td",30),w.Jc(1),w.Rb()),2&e){const e=w.jc().$implicit,t=w.jc();w.Bb(1),w.Kc(t.niceBytes(e.storage))}}function k(e,t){if(1&e){const e=w.Tb();w.Sb(0,"tr"),w.Sb(1,"td",30),w.Jc(2),w.Rb(),w.Sb(3,"td"),w.Jc(4),w.Rb(),w.Sb(5,"td",30),w.Jc(6),w.Rb(),w.Hc(7,j,2,1,"td",31),w.Hc(8,x,2,1,"td",31),w.Sb(9,"td",30),w.Sb(10,"button",51),w.fc("click",(function(){w.zc(e);const i=t.$implicit;return w.jc().deleteApplication(i.name)})),w.Sb(11,"span",52),w.Nb(12,"i",53),w.Rb(),w.Rb(),w.Rb(),w.Rb()}if(2&e){const e=t.$implicit,i=t.index,a=w.jc();w.Bb(2),w.Kc(i+1),w.Bb(2),w.Kc(e.name),w.Bb(2),w.Kc(e.liveStreamCount),w.Bb(1),w.qc("ngIf",a.isMobileMenu()),w.Bb(1),w.qc("ngIf",a.isMobileMenu())}}a=$localize`:@@cpuLoadLabel␟cd94d7d170a196bd47ac49304c33e452d657702f␟1787030470314877664:System CPU Load`,c=$localize`:@@cpuLoadLabel␟c040a21d57546f25841db7eb1cee5463e3ee9991␟220171137157560388:AMS CPU Load`,n=$localize`:@@liveStreamCountLabel␟84a3c85a4cbc9125c4f722fb823503ce2fe6a65c␟4776132880318610364:Active Live Streams`,s=$localize`:@@diskUsageLabel␟fd646b1a7b8b3bf29bd758b6e2a1ee851053d6aa␟3333453926782750251:System Disk`,o=$localize`:@@jvmNativeUsageLabel␟d35f4772670cb5298abefbf03341cb7d67e27f50␟7053430177496756068:System Memory`,r=$localize`:@@serverMemoryUsageLabel␟4507792df4d5e2833db387a68f3b67edc47671ba␟7872730209411387804:JVM Heap Memory`,b=$localize`:@@applicationsTitle␟67a94bdfbc3ae31c30b69b11676f19e03256232b␟6609618079638744324:New Application`,l=$localize`:@@appName␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,p=$localize`:@@liveStreamCountLabel␟56aa2d870d6e4acf67d3a609971f9e13f7cb95a9␟1849716262582008823:Live Stream`,d=$localize`:@@vodCountLabel␟ea6bebc8757b7c4fb864873be159ab8df8639862␟7975642438628428227:VoD Count`,h=$localize`:@@appStorageSizeLabel␟1fd6dbd0942f77002d852d7744dcb991cdd464d8␟57403663622654391:Storage`;const T=[{path:"",children:[{path:"",redirectTo:"overview"},{path:"overview",component:(()=>{class e{constructor(e,t,i,a,c){this.auth=e,this.restService=t,this.supportRestService=i,this.router=a,this.dialog=c,this.sentSuccess=!1,this.processing=!1,this.isClusterMode=!1,this.cpuLoadIntervalId=0,this.systemMemoryUsagePercent=0,this.units=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],this.newApplicationActive=!1,this.newAppCreating=!1,this.deployingApplication=!1,this.warFileToUpload=null}niceBytes(e){let t=0,i=parseInt(e,10)||0;for(;i>=1024;)i/=1024,t++;return i.toFixed(i>=100||t<1?0:1)+" "+this.units[t]}initCirclePercentage(){$("#chartDiskUsage,#chartJvmHeapUsage,#chartNativeMemoryUsage,#chartSystemMemory").easyPieChart({lineWidth:9,size:160,scaleColor:!1,trackColor:"#BBDEFB",barColor:"#1565C0",animate:!1})}ngOnInit(){this.appTableData={dataRows:[]}}ngAfterViewInit(){this.initCirclePercentage(),this.getSystemResources(),this.getApplicationsInfo(),this.timerId=window.setInterval(()=>{this.getSystemResources(),this.getApplicationsInfo()},5e3),this.auth.initLicenseCheck(),this.restService.isInClusterMode().subscribe(e=>{this.isClusterMode=e.success,this.isClusterMode||window.setTimeout(()=>{this.checkShutdownProperly()},1e4)},e=>{Object(f.g)(e)})}ngOnDestroy(){this.timerId&&clearInterval(this.timerId)}checkShutdownProperly(){let e=[];for(var t=0;t<this.appTableData.dataRows.length;t++)e.push(this.appTableData.dataRows[t].name);this.restService.isShutdownProperly(e.join(",")).subscribe(t=>{0==t.success&&(swal({title:"Unexpected Shutdown",text:"We've detected that your instance has not been shutdown gracefully. Just enter your e-mail and click the Submit button to let us have the logs about the problem",type:"warning",input:"email",inputPlaceholder:"Please enter your email address",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Submit"}).then(e=>{var t=new y.a;t.name="",t.email=e,t.sendSystemInfo=!0,t.title="In App Shutdown Properly",t.description="Shutdown error email with logs",this.processing=!0,this.supportRestService.sendRequest(t).subscribe(e=>{this.processing=!1,1==e.success?(this.sentSuccess=!0,$.notify({icon:"ti-email",message:"Your request has been sent. Support team will contact through your e-mail soon."},{type:"success",delay:5e3,placement:{from:"top",align:"right"}})):$.notify({icon:"ti-alert",message:"Your request couldn't be sent. Please try again or send email to support@antmedia.io"},{type:"warning",delay:5e3,placement:{from:"top",align:"right"}})},e=>{Object(f.g)(e)})}).catch((function(e){console.error("Error in shutdown properly: "+e)})),this.restService.setShutdownProperly(e.join(",")).subscribe(e=>{},e=>{Object(f.g)(e)}))},e=>{console.error("Server returns error: "+e.status+" for shutdown-properly"),setTimeout(()=>{this.checkShutdownProperly()},1e4),Object(f.g)(e)})}getSystemResources(){this.restService.getSystemResourcesInfo().subscribe(e=>{this.systemCpuLoad=Number(e.cpuUsage.systemCPULoad),this.processCpuLoad=Number(e.cpuUsage.processCPULoad),this.liveStreamSize=Number(e.totalLiveStreamSize),this.systemMemoryTotal=Number(e.systemMemoryInfo.totalMemory),this.systemMemoryInUse=Number(e.systemMemoryInfo.inUseMemory);var t=Number(e.systemMemoryInfo.availableMemory);0!=t&&(this.systemMemoryInUse=this.systemMemoryTotal-t),this.systemMemoryUsagePercent=Math.round(100*this.systemMemoryInUse/this.systemMemoryTotal),$("#chartSystemMemory").data("easyPieChart").update(this.systemMemoryUsagePercent),this.diskInUseSpace=Number(e.fileSystemInfo.inUseSpace),this.diskTotalSpace=Number(e.fileSystemInfo.totalSpace),this.diskUsagePercent=Math.round(100*this.diskInUseSpace/this.diskTotalSpace),$("#chartDiskUsage").data("easyPieChart").update(this.diskUsagePercent),this.jvmNativeInUse=Number(e.jvmNativeMemoryUsage.inUseMemory),this.jvmNativeMax=Number(e.jvmNativeMemoryUsage.maxMemory),this.jvmNativeUsagePercent=Math.round(Number(100*this.jvmNativeInUse/this.jvmNativeMax)),this.jvmHeapInUseSpace=Number(e.jvmMemoryUsage.inUseMemory),this.jvmHeapTotalSpace=Number(e.jvmMemoryUsage.maxMemory),this.jvmHeapUsagePercent=Math.round(Number(100*this.jvmHeapInUseSpace/this.jvmHeapTotalSpace)),$("#chartJvmHeapUsage").data("easyPieChart").update(this.jvmHeapUsagePercent)},this.handleError)}handleError(e){console.log("error status: "+e.status),401==e.status&&console.log(this.router),Object(f.g)(e)}getApplicationsInfo(){this.restService.getApplicationsInfo().subscribe(e=>{for(var t in this.appTableData.dataRows=[],e)this.appTableData.dataRows.push(e[t])},e=>{Object(f.g)(e)})}isMobileMenu(){return $(window).width()>991}newApplication(){this.newApplicationActive=!0,this.warFileToUpload=null}handleWarFileInput(e){this.warFileToUpload=e.item(0)}cancelNewApplication(){this.newApplicationActive=!1,this.newApplicationName=""}checkApplicationDeleted(e){setTimeout(()=>{this.restService.getApplications().subscribe(t=>{var i=!1;for(var a in t.applications)if(t.applications[a]==e){i=!0;break}i?this.checkApplicationDeleted(e):($.notify({icon:"ti-save",message:"Application is deleted."},{type:"success",delay:3e3,placement:{from:"top",align:"right"}}),this.getApplicationsInfo(),this.restService.getSidebar().initApplications())},e=>{console.log("Error occured: "+e),Object(f.g)(e)})},2e3)}checkApplicationCreated(e){setTimeout(()=>{this.restService.getApplications().subscribe(t=>{var i=!1;for(var a in t.applications)if(t.applications[a]==e){i=!0;break}i?(this.newAppCreating=!1,this.deployingApplication=!1,this.cancelNewApplication(),$.notify({icon:"ti-save",message:"Application is created."},{type:"success",delay:3e3,placement:{from:"top",align:"right"}}),this.getApplicationsInfo(),this.restService.getSidebar().initApplications()):this.checkApplicationCreated(e)},e=>{Object(f.g)(e)})},2e3)}createApplication(e){if(e){this.newAppCreating=!0;var t=null;null!=this.warFileToUpload&&((t=new FormData).append("file",this.warFileToUpload),t.append("file_info",this.warFileToUpload.name)),this.restService.createApplication(this.newApplicationName,t).subscribe(e=>{1==e.success?(this.deployingApplication=!0,this.checkApplicationCreated(this.newApplicationName)):(this.newAppCreating=!1,swal({title:"Application is not created",text:e.message,type:"error",confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(()=>{}).catch((function(){})))},e=>{Object(f.g)(e),this.newAppCreating=!1,null!=e&&403==e.status||swal({title:"Application is not created",text:"Make sure that you use alphanumeric characters in the application name",type:"error",confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(()=>{}).catch((function(){}))})}}deleteApplication(e){swal({title:R.a.getLocaleInterface().are_you_sure,text:R.a.getLocaleInterface().wont_be_able_to_revert,type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(()=>{this.restService.deleteApplication(e).subscribe(t=>{1==t.success?this.checkApplicationDeleted(e):$.notify({icon:"ti-save",message:"Application is not deleted. Please send logs to the support team"},{type:"warning",delay:3e3,placement:{from:"top",align:"right"}})},e=>{Object(f.g)(e),null!=e&&403==e.status||swal({title:"Application is not deleted",text:"Please send logs files under log directory to the Ant Media Support(support@antmedia.io)",type:"error",confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(()=>{}).catch((function(){}))})}).catch((function(){}))}}return e.\u0275fac=function(t){return new(t||e)(w.Mb(v.a),w.Mb(f.e),w.Mb(g.a),w.Mb(u.c),w.Mb(M.b))},e.\u0275cmp=w.Gb({type:e,selectors:[["overview-cmp"]],decls:102,vars:16,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-lg-4","col-sm-4"],[1,"card"],[1,"card-content"],[1,"col-xs-5"],[1,"icon-big","icon-warning","text-center"],[1,"ti-server"],[1,"col-xs-7"],[1,"numbers"],[1,"card-footer"],[1,"icon-big","icon-danger","text-center"],[1,"ti-dashboard"],[1,"icon-big","icon-success","text-center"],[1,"ti-wallet"],[1,"card","card-circle-chart"],[1,"card-header","text-center"],[1,"card-title"],[1,"description"],["id","chartDiskUsage",1,"chart-circle"],["id","chartSystemMemory",1,"chart-circle"],["id","chartJvmHeapUsage",1,"chart-circle"],[1,"col-md-12"],[2,"padding-top","15px"],[1,"text-right",2,"float","right","margin-right","15px"],["role","button",1,"btn","btn-fill","btn-success",3,"click"],["style","padding:45px",4,"ngIf"],[1,"card-content","table-full-width"],[1,"table","table-striped"],[1,"text-center"],["class","text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"padding","45px"],["method","post","validate","",3,"ngSubmit"],["f","ngForm"],[1,"form-group","text-left"],["type","text","required","","minlength","4","name","applicationName","placeholder","Application name",1,"form-control",3,"ngModel","ngModelChange"],["applicationName","ngModel"],[1,"text-danger",3,"hidden"],["class","text-danger",4,"ngIf"],["type","file","accept",".war",1,"upload",3,"change"],[1,"help-block"],[1,"form-group","text-center"],["type","submit",1,"btn","btn-fill","btn-success",3,"disabled"],["class","fa fa-spinner fa-pulse fa-1x fa-fw","aria-hidden","true",4,"ngIf"],["type","button",1,"btn","btn-simple",3,"click"],["class","text-info",4,"ngIf"],[1,"text-danger"],["aria-hidden","true",1,"fa","fa-spinner","fa-pulse","fa-1x","fa-fw"],[1,"text-info"],["type","button",1,"btn","btn-simple","btn-danger",3,"click"],[1,"btn-label"],[1,"ti-close"]],template:function(e,t){1&e&&(w.Sb(0,"div",0),w.Sb(1,"div",1),w.Sb(2,"div",2),w.Sb(3,"div",3),w.Sb(4,"div",4),w.Sb(5,"div",5),w.Sb(6,"div",2),w.Sb(7,"div",6),w.Sb(8,"div",7),w.Nb(9,"i",8),w.Rb(),w.Rb(),w.Sb(10,"div",9),w.Sb(11,"div",10),w.Sb(12,"p"),w.Wb(13,a),w.Rb(),w.Jc(14),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Sb(15,"div",11),w.Nb(16,"hr"),w.Rb(),w.Rb(),w.Rb(),w.Sb(17,"div",3),w.Sb(18,"div",4),w.Sb(19,"div",5),w.Sb(20,"div",2),w.Sb(21,"div",6),w.Sb(22,"div",12),w.Nb(23,"i",13),w.Rb(),w.Rb(),w.Sb(24,"div",9),w.Sb(25,"div",10),w.Sb(26,"p"),w.Wb(27,c),w.Rb(),w.Jc(28),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Sb(29,"div",11),w.Nb(30,"hr"),w.Rb(),w.Rb(),w.Rb(),w.Sb(31,"div",3),w.Sb(32,"div",4),w.Sb(33,"div",5),w.Sb(34,"div",2),w.Sb(35,"div",6),w.Sb(36,"div",14),w.Nb(37,"i",15),w.Rb(),w.Rb(),w.Sb(38,"div",9),w.Sb(39,"div",10),w.Sb(40,"p"),w.Wb(41,n),w.Rb(),w.Jc(42),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Sb(43,"div",11),w.Nb(44,"hr"),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Sb(45,"div",2),w.Sb(46,"div",3),w.Sb(47,"div",16),w.Sb(48,"div",17),w.Sb(49,"h5",18),w.Wb(50,s),w.Rb(),w.Sb(51,"p",19),w.Jc(52),w.Rb(),w.Rb(),w.Sb(53,"div",5),w.Sb(54,"div",20),w.Jc(55),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Sb(56,"div",3),w.Sb(57,"div",16),w.Sb(58,"div",17),w.Sb(59,"h5",18),w.Wb(60,o),w.Rb(),w.Sb(61,"p",19),w.Jc(62),w.Rb(),w.Rb(),w.Sb(63,"div",5),w.Sb(64,"div",21),w.Jc(65),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Sb(66,"div",3),w.Sb(67,"div",16),w.Sb(68,"div",17),w.Sb(69,"h5",18),w.Wb(70,r),w.Rb(),w.Sb(71,"p",19),w.Jc(72),w.Rb(),w.Rb(),w.Sb(73,"div",5),w.Sb(74,"div",22),w.Jc(75),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Sb(76,"div",2),w.Sb(77,"div",23),w.Sb(78,"div",4),w.Sb(79,"div",24),w.Sb(80,"div",25),w.Sb(81,"button",26),w.fc("click",(function(){return t.newApplication()})),w.Wb(82,b),w.Rb(),w.Rb(),w.Nb(83,"br"),w.Nb(84,"br"),w.Rb(),w.Hc(85,U,25,6,"div",27),w.Sb(86,"div",28),w.Sb(87,"table",29),w.Sb(88,"thead"),w.Sb(89,"tr"),w.Sb(90,"th",30),w.Jc(91,"#"),w.Rb(),w.Sb(92,"th"),w.Wb(93,l),w.Rb(),w.Sb(94,"th",30),w.Wb(95,p),w.Rb(),w.Hc(96,C,2,0,"th",31),w.Hc(97,N,2,0,"th",31),w.Sb(98,"th",30),w.Jc(99,"Action"),w.Rb(),w.Rb(),w.Rb(),w.Sb(100,"tbody"),w.Hc(101,k,13,5,"tr",32),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Rb(),w.Rb()),2&e&&(w.Bb(14),w.Lc(" ",t.systemCpuLoad,"% "),w.Bb(14),w.Lc(" ",t.processCpuLoad,"% "),w.Bb(14),w.Lc(" ",t.liveStreamSize," "),w.Bb(10),w.Mc("",t.niceBytes(t.diskInUseSpace)," / ",t.niceBytes(t.diskTotalSpace),""),w.Bb(3),w.Lc("",t.diskUsagePercent,"%"),w.Bb(7),w.Mc("",t.niceBytes(t.systemMemoryInUse)," / ",t.niceBytes(t.systemMemoryTotal),""),w.Bb(3),w.Lc("",t.systemMemoryUsagePercent,"%"),w.Bb(7),w.Mc("",t.niceBytes(t.jvmHeapInUseSpace)," / ",t.niceBytes(t.jvmHeapTotalSpace),""),w.Bb(3),w.Lc("",t.jvmHeapUsagePercent,"%"),w.Bb(10),w.qc("ngIf",t.newApplicationActive),w.Bb(11),w.qc("ngIf",t.isMobileMenu()),w.Bb(1),w.qc("ngIf",t.isMobileMenu()),w.Bb(4),w.qc("ngForOf",t.appTableData.dataRows))},directives:[m.o,m.n,S.x,S.l,S.m,S.d,S.t,S.g,S.k,S.n],encapsulation:2}),e})()}]}];var L=i("tk/3"),P=i("eikZ"),J=i("UO6m");let z=(()=>{class e{}return e.\u0275mod=w.Kb({type:e}),e.\u0275inj=w.Jb({factory:function(t){return new(t||e)},providers:[P.a,J.a],imports:[[m.c,u.f.forChild(T),S.f,L.c,M.f]]}),e})()}}]);